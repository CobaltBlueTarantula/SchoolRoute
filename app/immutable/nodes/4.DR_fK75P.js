const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["../chunks/CpOGMVz4.js","../chunks/CqkleIqs.js","../assets/leaflet.CIGW-MKW.css","../chunks/DEO1QmyJ.js"])))=>i.map(i=>d[i]);
import"../chunks/DsnmJJEf.js";import{p as P,ax as U,s as g,k as N,n as A,b as u,c as j,aC as I,f as b,h as w,d as m,i as c,g as f,t as O,j as L,aD as B,aE as q,o as V,aF as H,m as J}from"../chunks/h7MUBmDw.js";import{i as C}from"../chunks/CfDQ-aYo.js";import{s as K,p as Q,l as W,w as X,g as Y}from"../chunks/BfYoJKqa.js";import{_ as T}from"../chunks/D9Z9MdNV.js";import{p as M}from"../chunks/r0bgQIrM.js";import{b as R}from"../chunks/COTbmHOi.js";import{i as Z}from"../chunks/BPwULdUY.js";import{e as $,b as ee,i as te}from"../chunks/DNQEJwGN.js";import{r as ae}from"../chunks/DvPZ1a-0.js";var oe=b("<p> </p>"),se=b('<div class="skeleton h-4 w-3/5"></div> <div class="skeleton h-4 w-full"></div> <div class="skeleton h-4 w-5/6"></div>',1),le=b('<h1 class="font-semibold text-[18px] pb-2">Route: <span class="text-[#237CC9]"> </span></h1> <h2 class="font-semibold text-[18px] pb-6">School: <span class="text-[#237CC9]"> </span></h2> <section class="mt-5 flex flex-col gap-6"><!></section>',1),re=b('<li>A <span class="font-bold">school</span></li>'),ne=b('<li>A <span class="font-bold">route</span> on the map</li>'),ie=b('<div class="p-4 bg-yellow-50 border-l-4 border-yellow-400 text-yellow-800 rounded"><h2 class="font-semibold text-lg mb-2">Please select:</h2> <ul class="list-disc ml-6"><!> <!></ul></div>');function ce(S,o){P(o,!0);let r=I(""),n=0;U(async()=>{if(o.selectedRoute&&o.selectedSchool){g(r,"");const e=++n,a=await K(o.selectedSchool,o.selectedRoute);e===n&&g(r,a,!0)}});var v=N(),d=A(v);{var i=e=>{var a=le(),s=A(a),t=w(m(s)),_=m(t,!0);c(t),c(s);var p=w(s,2),y=w(m(p)),l=m(y,!0);c(y),c(p);var x=w(p,2),D=m(x);{var z=k=>{var E=oe(),G=m(E,!0);c(E),O(()=>L(G,f(r))),u(k,E)},F=k=>{var E=se();B(4),u(k,E)};C(D,k=>{f(r)?k(z):k(F,!1)})}c(x),O(()=>{L(_,o.selectedRoute.long_name),L(l,o.selectedSchool.name)}),u(e,a)},h=e=>{var a=ie(),s=w(m(a),2),t=m(s);{var _=l=>{var x=re();u(l,x)};C(t,l=>{o.selectedSchool||l(_)})}var p=w(t,2);{var y=l=>{var x=ne();u(l,x)};C(p,l=>{o.selectedRoute||l(y)})}c(s),c(a),u(e,a)};C(d,e=>{o.selectedRoute&&o.selectedSchool?e(i):e(h,!1)})}u(S,v),j()}var de=b('<div id="map" class="card bg-base-100 h-[80vh] m-4 md:m-8 p-6 md:p-15 shadow-sm drop-shadow-2xl"></div>');function me(S,o){P(o,!0);const r=q();let n,v,d=M(o,"selectedSchool",7),i;U(()=>{if(d()&&n){const e=n.find(a=>a.name==d().name);e&&i.setView([e.geo_point.lat,e.geo_point.lon],17)}}),V(async()=>{const e=(await T(async()=>{const{default:t}=await import("../chunks/CpOGMVz4.js").then(_=>_.l);return{default:t}},__vite__mapDeps([0,1]),import.meta.url)).default;await T(()=>Promise.resolve({}),__vite__mapDeps([2]),import.meta.url),await T(()=>import("../chunks/DEO1QmyJ.js").then(t=>t.l),__vite__mapDeps([3,1]),import.meta.url),i=e.map("map").setView([-35.2,149.1],12),e.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"&copy; OpenStreetMap contributors"}).addTo(i),v=Q(await W(`${R}/routes.csv`)),n=await(await fetch(`${R}/schools.json`)).json();const s=e.markerClusterGroup();delete e.Icon.Default.prototype._getIconUrl,e.Icon.Default.mergeOptions({iconRetinaUrl:`${R}/leaflet/images/marker-icon-2x.png`,iconUrl:`${R}/leaflet/images/marker-icon.png`,shadowUrl:`${R}/leaflet/images/marker-shadow.png`}),n.forEach(t=>{const _=e.marker([t.geo_point.lat,t.geo_point.lon]).on("click",p=>{d(t),r("schoolSelected",t)}).bindPopup(t.name);s.addLayer(_)}),i.addLayer(s),v.forEach(t=>{X(t.the_geom).forEach(p=>{e.polyline(p,{color:Y(),weight:5}).on("click",y=>{r("routeSelected",t)}).addTo(i).bindPopup(t.long_name)})})});var h=de();u(S,h),j()}var ve=b("<option></option>"),pe=b('<input type="text" class="input" placeholder="Select a school" list="schools"/> <datalist id="schools"></datalist>',1);function ue(S,o){P(o,!1);const r=q();let n=M(o,"value",12,""),v=J([]);V(async()=>{const a=await(await fetch(`${R}/schools.json`)).json(),s=new Set;a.forEach(t=>{s.add(t.name)}),g(v,Array.from(s).sort())}),Z();var d=pe(),i=A(d);ae(i);var h=w(i,2);$(h,5,()=>f(v),te,(e,a)=>{var s=ve(),t={};O(()=>{t!==(t=f(a))&&(s.value=(s.__value=f(a))??"")}),u(e,s)}),c(h),ee(i,n),H("input",i,e=>r("input",e.target.value)),u(S,d),j()}var fe=b('<div class="flex flex-col md:flex-row w-full"><section class="md:w-1/3 h-76"><div class="mb-10 shadow-sm drop-shadow-2xl m-4 md:m-8 p-6 md:p-10 card bg-base-100"><h1 class="font-semibold text-2xl pb-6">Public Transport Services</h1> <h2 class="pb-3">Search Schools</h2> <!></div> <div class="mb-10 shadow-sm drop-shadow-2xl m-4 md:m-8 p-6 md:p-10 card bg-base-100"><!></div></section> <section class="md:w-2/3 md:mt-0 mt-32 w-1xl"><!></section></div>');function Ee(S,o){P(o,!0);let r=I(void 0),n=I(void 0),v=[],d=I("");V(async()=>{v=await(await fetch(`${R}/schools.json`)).json()});function i(l){g(d,l.detail,!0);const x=v.find(D=>D.name===f(d));x&&(g(n,void 0),g(r,x,!0))}var h=fe(),e=m(h),a=m(e),s=w(m(a),4);ue(s,{get value(){return f(d)},$$events:{input:i}}),c(a);var t=w(a,2),_=m(t);ce(_,{get selectedRoute(){return f(n)},get selectedSchool(){return f(r)}}),c(t),c(e);var p=w(e,2),y=m(p);me(y,{get selectedSchool(){return f(r)},$$events:{schoolSelected:l=>{g(n,void 0),g(r,l.detail,!0),g(d,f(r).name,!0)},routeSelected:l=>g(n,l.detail,!0)}}),c(p),c(h),u(S,h),j()}export{Ee as component};
