const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["../chunks/CpOGMVz4.js","../chunks/CqkleIqs.js","../assets/leaflet.CIGW-MKW.css","../chunks/DEO1QmyJ.js"])))=>i.map(i=>d[i]);
import"../chunks/DsnmJJEf.js";import{p as P,ax as q,s as b,k as B,n as A,b as u,c as j,aC as C,f as g,h as w,d as v,i as c,g as h,t as D,j as L,aD as H,aE as M,o as O,aF as J,m as K}from"../chunks/h7MUBmDw.js";import{i as E}from"../chunks/CfDQ-aYo.js";import{s as Q,p as U,l as W,w as X,g as Y}from"../chunks/DTRYEj25.js";import{_ as T}from"../chunks/D9Z9MdNV.js";import{p as z}from"../chunks/r0bgQIrM.js";import{b as V}from"../chunks/Bv6Hlwbg.js";import{i as Z}from"../chunks/BPwULdUY.js";import{e as $,b as ee,i as te}from"../chunks/DNQEJwGN.js";import{r as oe}from"../chunks/DvPZ1a-0.js";var ae=g("<p> </p>"),se=g('<div class="skeleton h-4 w-3/5"></div> <div class="skeleton h-4 w-full"></div> <div class="skeleton h-4 w-5/6"></div>',1),le=g('<h1 class="font-semibold text-[18px] pb-2">Route: <span class="text-[#237CC9]"> </span></h1> <h2 class="font-semibold text-[18px] pb-6">School: <span class="text-[#237CC9]"> </span></h2> <section class="mt-5 flex flex-col gap-6"><!></section>',1),re=g('<li>A <span class="font-bold">school</span></li>'),ne=g('<li>A <span class="font-bold">route</span> on the map</li>'),ie=g('<div class="p-4 bg-yellow-50 border-l-4 border-yellow-400 text-yellow-800 rounded"><h2 class="font-semibold text-lg mb-2">Please select:</h2> <ul class="list-disc ml-6"><!> <!></ul></div>');function ce(S,a){P(a,!0);let r=C(""),n=0;q(async()=>{if(a.selectedRoute&&a.selectedSchool){b(r,"");const e=++n,o=await Q(a.selectedSchool,a.selectedRoute);e===n&&b(r,o,!0)}});var m=B(),d=A(m);{var i=e=>{var o=le(),s=A(o),t=w(v(s)),_=v(t,!0);c(t),c(s);var p=w(s,2),y=w(v(p)),l=v(y,!0);c(y),c(p);var x=w(p,2),I=v(x);{var F=R=>{var k=ae(),N=v(k,!0);c(k),D(()=>L(N,h(r))),u(R,k)},G=R=>{var k=se();H(4),u(R,k)};E(I,R=>{h(r)?R(F):R(G,!1)})}c(x),D(()=>{L(_,a.selectedRoute.long_name),L(l,a.selectedSchool.name)}),u(e,o)},f=e=>{var o=ie(),s=w(v(o),2),t=v(s);{var _=l=>{var x=re();u(l,x)};E(t,l=>{a.selectedSchool||l(_)})}var p=w(t,2);{var y=l=>{var x=ne();u(l,x)};E(p,l=>{a.selectedRoute||l(y)})}c(s),c(o),u(e,o)};E(d,e=>{a.selectedRoute&&a.selectedSchool?e(i):e(f,!1)})}u(S,m),j()}var de=g('<div id="map" class="card bg-base-100 h-[80vh] m-4 md:m-8 p-6 md:p-15 shadow-sm drop-shadow-2xl"></div>');function ve(S,a){P(a,!0);const r=M();let n,m,d=z(a,"selectedSchool",7),i;q(()=>{if(d()&&n){const e=n.find(o=>o.name==d().name);e&&i.setView([e.geo_point.lat,e.geo_point.lon],17)}}),O(async()=>{const e=(await T(async()=>{const{default:t}=await import("../chunks/CpOGMVz4.js").then(_=>_.l);return{default:t}},__vite__mapDeps([0,1]),import.meta.url)).default;await T(()=>Promise.resolve({}),__vite__mapDeps([2]),import.meta.url),await T(()=>import("../chunks/DEO1QmyJ.js").then(t=>t.l),__vite__mapDeps([3,1]),import.meta.url),i=e.map("map").setView([-35.2,149.1],12),e.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"&copy; OpenStreetMap contributors"}).addTo(i),m=U(await W(`${V}/routes.csv`)),n=await(await fetch(`${V}/schools.json`)).json();const s=e.markerClusterGroup();n.forEach(t=>{const _=e.marker([t.geo_point.lat,t.geo_point.lon]).on("click",p=>{d(t),r("schoolSelected",t)}).bindPopup(t.name);s.addLayer(_)}),i.addLayer(s),m.forEach(t=>{X(t.the_geom).forEach(p=>{e.polyline(p,{color:Y(),weight:5}).on("click",y=>{r("routeSelected",t)}).addTo(i).bindPopup(t.long_name)})})});var f=de();u(S,f),j()}var me=g("<option></option>"),pe=g('<input type="text" class="input" placeholder="Select a school" list="schools"/> <datalist id="schools"></datalist>',1);function ue(S,a){P(a,!1);const r=M();let n=z(a,"value",12,""),m=K([]);O(async()=>{const o=await(await fetch(`${V}/schools.json`)).json(),s=new Set;o.forEach(t=>{s.add(t.name)}),b(m,Array.from(s).sort())}),Z();var d=pe(),i=A(d);oe(i);var f=w(i,2);$(f,5,()=>h(m),te,(e,o)=>{var s=me(),t={};D(()=>{t!==(t=h(o))&&(s.value=(s.__value=h(o))??"")}),u(e,s)}),c(f),ee(i,n),J("input",i,e=>r("input",e.target.value)),u(S,d),j()}var he=g('<div class="flex flex-col md:flex-row w-full"><section class="md:w-1/3 h-76"><div class="mb-10 shadow-sm drop-shadow-2xl m-4 md:m-8 p-6 md:p-10 card bg-base-100"><h1 class="font-semibold text-2xl pb-6">Public Transport Services</h1> <h2 class="pb-3">Search Schools</h2> <!></div> <div class="mb-10 shadow-sm drop-shadow-2xl m-4 md:m-8 p-6 md:p-10 card bg-base-100"><!></div></section> <section class="md:w-2/3 md:mt-0 mt-32 w-1xl"><!></section></div>');function Ee(S,a){P(a,!0);let r=C(void 0),n=C(void 0),m=[],d=C("");O(async()=>{m=await(await fetch("/schools.json")).json()});function i(l){b(d,l.detail,!0);const x=m.find(I=>I.name===h(d));x&&(b(n,void 0),b(r,x,!0))}var f=he(),e=v(f),o=v(e),s=w(v(o),4);ue(s,{get value(){return h(d)},$$events:{input:i}}),c(o);var t=w(o,2),_=v(t);ce(_,{get selectedRoute(){return h(n)},get selectedSchool(){return h(r)}}),c(t),c(e);var p=w(e,2),y=v(p);ve(y,{get selectedSchool(){return h(r)},$$events:{schoolSelected:l=>{b(n,void 0),b(r,l.detail,!0),b(d,h(r).name,!0)},routeSelected:l=>b(n,l.detail,!0)}}),c(p),c(f),u(S,f),j()}export{Ee as component};
